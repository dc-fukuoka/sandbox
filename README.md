sandbox
===

math equation test:  
<img src="https://latex.codecogs.com/gif.latex?X[n]&space;=&space;\sum_{k=0}^{N-1}x[k]\exp({-j\frac{2&space;\pi&space;nk}{N}})"/>  
<img src="https://latex.codecogs.com/gif.latex?\inline&space;X[n]&space;\in&space;\mathbb{C}" />  

diffusion equation:  
<img src="https://latex.codecogs.com/gif.latex?D\nabla^2&space;\psi&space;=&space;\frac{\partial&space;\psi}{\partial&space;t}" title="D\nabla^2 \psi = \frac{\partial \psi}{\partial t}" />  
<img src="https://latex.codecogs.com/gif.latex?\vec{\nabla}^2&space;=&space;\frac{\partial^2}{\partial&space;x^2}&space;&plus;&space;\frac{\partial^2}{\partial&space;y^2}&space;&plus;&space;\frac{\partial^2}{\partial&space;z^2}" title="\vec{\nabla}^2 = \frac{\partial^2}{\partial x^2} + \frac{\partial^2}{\partial y^2} + \frac{\partial^2}{\partial z^2}" />  
explicit method
====
* discretize this by central difference, time direction is forward difference
<img src="https://latex.codecogs.com/gif.latex?D\frac{(A^{n&plus;1}(i,j,k)-A^n(i,j,k))}{\Delta&space;t}&space;=&space;\frac{A^n(i&plus;1,j,k)x-2A^n(i,j,k)&plus;A^n(i-1,j,k)}{\Delta&space;x^2}&plus;\frac{A^n(i,j&plus;1,k)x-2A^n(i,j,k)&plus;A^n(i,j-1,k)}{\Delta&space;y^2}&plus;\frac{A^n(\&space;i,j,k&plus;1)x-2A^n(i,j,k)&plus;A^n(i,j,k-1)}{\Delta&space;x^2}" title="D\frac{(A^{n+1}(i,j,k)-A^n(i,j,k))}{\Delta t} = \frac{A^n(i+1,j,k)x-2A^n(i,j,k)+A^n(i-1,j,k)}{\Delta x^2}+\frac{A^n(i,j+1,k)x-2A^n(i,j,k)+A^n(i,j-1,k)}{\Delta y^2}+\frac{A^n(\ i,j,k+1)x-2A^n(i,j,k)+A^n(i,j,k-1)}{\Delta z^2}" />  
to make it simple, set <img src="https://latex.codecogs.com/gif.latex?\Delta&space;x&space;=&space;\Delta&space;y&space;=&space;\Delta&space;z" title="\Delta x = \Delta y = \Delta z" />  
<img src="https://latex.codecogs.com/gif.latex?A^{n&plus;1}(i,j,k)&space;=&space;\frac{\Delta&space;t}{D\Delta&space;x^2}\left&space;(A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)+A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)\right&space;)&plus;\left&space;(&space;1-\frac{6\Delta&space;t}{D\Delta&space;x^2}\right&space;)+A^n(i,j,k)&space;\newline&space;c_1&space;=&space;\frac{\Delta&space;t}{D\Delta&space;x^2}&space;\newline&space;c_2&space;=&space;1-6\frac{\Delta&space;t}{D\Delta&space;x^2}" title="A^{n+1}(i,j,k) = \frac{\Delta t}{D\Delta x^2}\left (A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1)\right )+\left ( 1-\frac{6\Delta t}{D\Delta x^2}\right )+A^n(i,j,k) \newline c_1 = \frac{\Delta t}{D\Delta x^2} \newline c_2 = 1-6\frac{\Delta t}{D\Delta x^2}" />  
<img src="https://latex.codecogs.com/gif.latex?A^{n&plus;1}(i,j,k)&space;=&space;c_1\left&space;(A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)+A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)\right&space;)&plus;c_2A^n(i,j,k)&space;\newline&space;A^{n&plus;1}&space;=&space;A_{new},&space;A^n&space;=&space;A&space;\newline&space;\newline&space;\therefore&space;A_{new}(i,j,k)&space;=&space;c_1\left&space;(A(i&plus;1,j,k)&plus;A(i-1,j,k)&plus;A(i,j&plus;1,k)+A(i,j-1,k)&plus;A(i,j,k&plus;1)&plus;A(i,j,k-1)\right&space;)&plus;c_2A(i,j,k)" title="A^{n+1}(i,j,k) = c_1\left (A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1)\right )+c_2A^n(i,j,k) \newline A^{n+1} = A_{new}, A^n = A \newline \newline \therefore A_{new}(i,j,k) = c_1\left (A(i+1,j,k)+A(i-1,j,k)+A(i,j+1,k)+A(i,j-1,k)+A(i,j,k+1)+A(i,j,k-1)\right )+c_2A(i,j,k)" />

implicit method
====
* discretize it by central difference, time direction is backward difference
<img src="https://latex.codecogs.com/gif.latex?D\frac{(A^{n&plus;1}(i,j,k)-A^n(i,j,k))}{\Delta&space;t}&space;=&space;\frac{A^{n&plus;1}(i&plus;1,j,k)x-2A^{n&plus;1}(i,j,k)&plus;A^{n&plus;1}(i-1,j,k)}{\Delta&space;x^2}&plus;\frac{A^{n&plus;1}(i,j&plus;1,k)x-2A^{n&plus;1}(i,j,k)&plus;A^{n&plus;1}(i,j-1,k)}{\Delta&space;y^2}&plus;\frac{A^{n&plus;1}(\&space;i,j,k&plus;1)x-2A^{n&plus;1}(i,j,k)&plus;A^{n&plus;1}(i,j,k-1)}{\Delta&space;z^2}" title="D\frac{(A^{n+1}(i,j,k)-A^n(i,j,k))}{\Delta t} = \frac{A^{n+1}(i+1,j,k)x-2A^{n+1}(i,j,k)+A^{n+1}(i-1,j,k)}{\Delta x^2}+\frac{A^{n+1}(i,j+1,k)x-2A^{n+1}(i,j,k)+A^{n+1}(i,j-1,k)}{\Delta y^2}+\frac{A^{n+1}(\ i,j,k+1)x-2A^{n+1}(i,j,k)+A^{n+1}(i,j,k-1)}{\Delta z^2}" />  
<img src="https://latex.codecogs.com/gif.latex?A^{n&plus;1}(i,j,k)-A^n(i,j,k)&space;=&space;\frac{\Delta&space;t}{D\Delta&space;x^2}\left&space;(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)-6A^{n&plus;1}(i,j,k)&space;\right&space;)&space;\newline&space;-\frac{\Delta&space;t}{D\Delta&space;x^2}\left(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)&space;\right&space;)&space;&plus;&space;\left&space;(&space;1&plus;\frac{6\Delta&space;t}{D\Delta&space;x^2}&space;\right&space;)A^{n&plus;1}(i,j,k)&space;=&space;A^n(i,j,k)&space;\newline&space;-\frac{\Delta&space;t}{D\Delta&space;x^2}&space;=&space;c_1,&space;\left&space;(&space;1&plus;\frac{6\Delta&space;t}{D\Delta&space;x^2}&space;\right&space;)&space;=&space;c_2&space;\newline&space;A^{n&plus;1}&space;=&space;A_{new},&space;A^n&space;=&space;A&space;\newline&space;\therefore&space;c_1\left(&space;A_{new}(i&plus;1,j,k)&plus;A_{new}(i-1,j,k)&plus;A_{new}(i,j&plus;1,k)&plus;A_{new}(i,j-1,k)&plus;A_{new}(i,j,k&plus;1)&plus;A_{new}(i,j,k-1)&space;\right&space;)&space;&plus;&space;c_2&space;A_{new}(i,j,k)&space;=&space;A(i,j,k)" title="A^{n+1}(i,j,k)-A^n(i,j,k) = \frac{\Delta t}{D\Delta x^2}\left ( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1)-6A^{n+1}(i,j,k) \right ) \newline -\frac{\Delta t}{D\Delta x^2}\left( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1) \right ) + \left ( 1+\frac{6\Delta t}{D\Delta x^2} \right )A^{n+1}(i,j,k) = A^n(i,j,k) \newline -\frac{\Delta t}{D\Delta x^2} = c_1, \left ( 1+\frac{6\Delta t}{D\Delta x^2} \right ) = c_2 \newline A^{n+1} = A_{new}, A^n = A \newline \therefore c_1\left( A_{new}(i+1,j,k)+A_{new}(i-1,j,k)+A_{new}(i,j+1,k)+A_{new}(i,j-1,k)+A_{new}(i,j,k+1)+A_{new}(i,j,k-1) \right ) + c_2 A_{new}(i,j,k) = A(i,j,k)" />  
interpet <img src="https://latex.codecogs.com/gif.latex?A(i,j,k)" title="A(i,j,k)" /> as one dimensional array, <img src="https://latex.codecogs.com/gif.latex?\mathbf{g}&space;=&space;i&space;&plus;&space;I_{max}*j&space;&plus;&space;I_{max}J_{max}*k" title="\mathbf{g} = i + I_{max}*j + I_{max}J_{max}*k" /> with colmn major ordering  
<img src="https://latex.codecogs.com/gif.latex?A(0:I_{max}&plus;1,0:J_{max}&plus;1,0:K_{max}&plus;1)" title="A(0:I_{max}+1,0:J_{max}+1,0:K_{max}+1)" />  
<img src="https://latex.codecogs.com/gif.latex?c_1\left(&space;A_{new}(\mathbf{g}&plus;1)&plus;A_{new}(\mathbf{g}-1)&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2))&plus;A_{new}(\mathbf{g}-(I_{max}&plus;2))&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2)(J_{max}&plus;2))&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2)(J_{max}&plus;2))&space;\right&space;)&space;&plus;&space;c_2&space;A_{new}(i,j,k)&space;=&space;A(\mathbf{g})&space;\newline&space;M\vec{x}&space;=&space;\vec{b},&space;\vec{x}&space;=&space;A_{new}(\mathbf{g})&space;\newline&space;M\vec{x}&space;=&space;c_1\left(&space;A_{new}(\mathbf{g}&plus;1)&plus;A_{new}(\mathbf{g}-1)&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2))&plus;A_{new}(\mathbf{g}-(I_{max}&plus;2))&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2)(J_{max}&plus;2))&plus;A_{new}(\mathbf{g}&plus;(I_{max}&plus;2)(J_{max}&plus;2))&space;\right&space;)&space;&plus;&space;c_2&space;A_{new}(i,j,k)" title="c_1\left( A_{new}(\mathbf{g}+1)+A_{new}(\mathbf{g}-1)+A_{new}(\mathbf{g}+(I_{max}+2))+A_{new}(\mathbf{g}-(I_{max}+2))+A_{new}(\mathbf{g}+(I_{max}+2)(J_{max}+2))+A_{new}(\mathbf{g}+(I_{max}+2)(J_{max}+2)) \right ) + c_2 A_{new}(i,j,k) = A(\mathbf{g}) \newline M\vec{x} = \vec{b}, \vec{x} = A_{new}(\mathbf{g}) \newline M\vec{x} = c_1\left( A_{new}(\mathbf{g}+1)+A_{new}(\mathbf{g}-1)+A_{new}(\mathbf{g}+(I_{max}+2))+A_{new}(\mathbf{g}-(I_{max}+2))+A_{new}(\mathbf{g}+(I_{max}+2)(J_{max}+2))+A_{new}(\mathbf{g}+(I_{max}+2)(J_{max}+2)) \right ) + c_2 A_{new}(i,j,k)" />  
solve this sparse(7-point stencil) matrix for each time step
  
Crank-Nicolson method
====
* descretize it by central difference, time direction is also central difference
<img src="https://latex.codecogs.com/gif.latex?D\frac{A^{n&plus;1}(i,j,k)-A^{n}(i,j,k)}{\Delta&space;t}&space;=&space;\newline&space;\frac{1}{2\Delta&space;x^2}&space;(\left&space;(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)-6A^{n&plus;1}(i,j,k)&space;\right&space;)&space;&plus;&space;\newline&space;\left&space;(&space;A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)&plus;A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)-6A^n(i,j,k)&space;\right&space;)&space;)&space;\newline&space;\newline&space;A^{n&plus;1}(i,j,k)-A^{n}(i,j,k)&space;=&space;\newline&space;\frac{D\Delta&space;t}{2\Delta&space;x^2}&space;(\left&space;(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)-6A^{n&plus;1}(i,j,k)&space;\right&space;)&space;&plus;&space;\newline&space;\left&space;(&space;A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)&plus;A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)-6A^n(i,j,k)&space;\right&space;)&space;)" title="D\frac{A^{n+1}(i,j,k)-A^{n}(i,j,k)}{\Delta t} = \newline \frac{1}{2\Delta x^2} (\left ( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1)-6A^{n+1}(i,j,k) \right ) + \newline \left ( A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1)-6A^n(i,j,k) \right ) ) \newline \newline A^{n+1}(i,j,k)-A^{n}(i,j,k) = \newline \frac{D\Delta t}{2\Delta x^2} (\left ( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1)-6A^{n+1}(i,j,k) \right ) + \newline \left ( A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1)-6A^n(i,j,k) \right ) )" />
<img src="https://latex.codecogs.com/gif.latex?-\frac{D\Delta&space;t}{2\Delta&space;x^2}\left&space;(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)&space;\right&space;)&space;&plus;&space;\left&space;(&space;1&space;&plus;&space;6\frac{D\Delta&space;t}{2\Delta&space;x^2}&space;\right&space;)A^{n&plus;1}(i,j,k)&space;=&space;\newline&space;\frac{D\Delta&space;t}{2\Delta&space;x^2}\left&space;(&space;A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)&plus;A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)&space;\right&space;)&plus;\left&space;(&space;1&space;-&space;6\frac{D\Delta&space;t}{2\Delta&space;x^2}&space;\right&space;)A^{n&plus;1}(i,j,k)&space;\newline&space;c_1&space;=&space;-\frac{D\Delta&space;t}{2\Delta&space;x^2},&space;c_2&space;=&space;1&space;&plus;&space;6\frac{D\Delta&space;t}{2\Delta&space;x^2},&space;c_3&space;=&space;\frac{D\Delta&space;t}{2\Delta&space;x^2},&space;c_4&space;=&space;1&space;-&space;6\frac{D\Delta&space;t}{2\Delta&space;x^2}&space;\newline&space;\newline&space;c_1\left&space;(&space;A^{n&plus;1}(i&plus;1,j,k)&plus;A^{n&plus;1}(i-1,j,k)&plus;A^{n&plus;1}(i,j&plus;1,k)&plus;A^{n&plus;1}(i,j-1,k)&plus;A^{n&plus;1}(i,j,k&plus;1)&plus;A^{n&plus;1}(i,j,k-1)&space;\right&space;)&space;&plus;&space;c_2A^{n&plus;1}(i,j,k)&space;=&space;\newline&space;c_3\left&space;(A^n(i&plus;1,j,k)&plus;A^n(i-1,j,k)&plus;A^n(i,j&plus;1,k)&plus;A^n(i,j-1,k)&plus;A^n(i,j,k&plus;1)&plus;A^n(i,j,k-1)&space;\right&space;)&plus;c_4A^{n}(i,j,k)" title="-\frac{D\Delta t}{2\Delta x^2}\left ( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1) \right ) + \left ( 1 + 6\frac{D\Delta t}{2\Delta x^2} \right )A^{n+1}(i,j,k) = \newline \frac{D\Delta t}{2\Delta x^2}\left ( A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1) \right )+\left ( 1 - 6\frac{D\Delta t}{2\Delta x^2} \right )A^{n+1}(i,j,k) \newline c_1 = -\frac{D\Delta t}{2\Delta x^2}, c_2 = 1 + 6\frac{D\Delta t}{2\Delta x^2}, c_3 = \frac{D\Delta t}{2\Delta x^2}, c_4 = 1 - 6\frac{D\Delta t}{2\Delta x^2} \newline \newline c_1\left ( A^{n+1}(i+1,j,k)+A^{n+1}(i-1,j,k)+A^{n+1}(i,j+1,k)+A^{n+1}(i,j-1,k)+A^{n+1}(i,j,k+1)+A^{n+1}(i,j,k-1) \right ) + c_2A^{n+1}(i,j,k) = \newline c_3\left (A^n(i+1,j,k)+A^n(i-1,j,k)+A^n(i,j+1,k)+A^n(i,j-1,k)+A^n(i,j,k+1)+A^n(i,j,k-1) \right )+c_4A^{n}(i,j,k)" />  


  
Nekrasov partition function:  
<img src="https://latex.codecogs.com/gif.latex?Z(a,&space;\epsilon_1,&space;\epsilon_2;&space;q)&space;=&space;\sum_{k=0}^{\infty}q^k\oint_{\tilde{\emph{M}}_k}1" title="Z(a, \epsilon_1, \epsilon_2; q) = \sum_{k=0}^{\infty}q^k\oint_{\tilde{\emph{M}}_k}1" />  
<img src="https://latex.codecogs.com/gif.latex?\oint_{\tilde{\emph{M}}_k}1&space;=&space;\int_{\tilde{\emph{M}}_k}exp\omega&space;&plus;&space;\mu_G(a)&space;&plus;&space;\mu_{\textbf{T}^2}(\epsilon_1,&space;\epsilon_2)" title="\oint_{\tilde{\emph{M}}_k}1 = \int_{\tilde{\emph{M}}_k}exp\omega + \mu_G(a) + \mu_{\textbf{T}^2}(\epsilon_1, \epsilon_2)" />  
<img src="https://latex.codecogs.com/gif.latex?Z(a,&space;\epsilon_1,&space;\epsilon_2;&space;q)&space;=&space;\exp{\frac{\mathit{F^{inst}(a,&space;\epsilon_1,&space;\epsilon_2;&space;q)}}{\epsilon_1\epsilon_2}}" title="Z(a, \epsilon_1, \epsilon_2; q) = \exp{\frac{\mathit{F^{inst}(a, \epsilon_1, \epsilon_2; q)}}{\epsilon_1\epsilon_2}}" />  
<img src="https://latex.codecogs.com/gif.latex?\epsilon_1&space;=&space;-\epsilon_2&space;=&space;\hbar,&space;G&space;=&space;SU(N)&space;\newline&space;Z(a,&space;\hbar,&space;-\hbar;&space;q)&space;=&space;\sum_{\vec{\mathbf{k}}}q^{|\mathbf{k}|}\prod_{(l,i)\ne(n,j)}{\frac{a_{ln}&plus;\hbar(k_{l,i}-k_{n,j}&plus;j-i)}{a_{ln}&space;&plus;&space;\hbar(j-i)}}&space;\newline&space;a_{ln}&space;=&space;a_l&space;-&space;a_n,&space;\vec{\mathbf{k}}&space;=&space;(\mathbf{k_1},...,\mathbf{k_N})&space;\newline&space;|\vec{\mathbf{k}}|&space;=&space;\sum_{l,i}k_{l,i}" title="\epsilon_1 = -\epsilon_2 = \hbar, G = SU(N) \newline Z(a, \hbar, -\hbar; q) = \sum_{\vec{\mathbf{k}}}q^{|\mathbf{k}|}\prod_{(l,i)\ne(n,j)}{\frac{a_{ln}+\hbar(k_{l,i}-k_{n,j}+j-i)}{a_{ln} + \hbar(j-i)}} \newline a_{ln} = a_l - a_n, \vec{\mathbf{k}} = (\mathbf{k_1},...,\mathbf{k_N}) \newline |\vec{\mathbf{k}}| = \sum_{l,i}k_{l,i}" />
  
